<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ï£ºÍ∞Ñ Ìä∏Î†åÎìú Î¶¨Ìè¨Ìä∏</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React & ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Firebase ES Modules Loader -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
    
    // React(Babel) ÏòÅÏó≠ÏóêÏÑú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎèÑÎ°ù Ï†ÑÏó≠ Í∞ùÏ≤¥Ïóê Ìï†ÎãπÌï©ÎãàÎã§.
    window.FirebaseLibs = { initializeApp, getAuth, signInAnonymously, onAuthStateChanged, getFirestore, doc, onSnapshot, setDoc, updateDoc };
  </script>
</head>
<body class="bg-[#0a0a0a] m-0">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;
    const { initializeApp, getAuth, signInAnonymously, onAuthStateChanged, getFirestore, doc, onSnapshot, setDoc, updateDoc } = window.FirebaseLibs;

    // --- Firebase Configuration ---
    const firebaseConfig = {
      apiKey: "AIzaSyD-xTDMGyeS25VLPGXPirrOIdJwGVL_a0Q",
      authDomain: "trend-report-8a183.firebaseapp.com",
      projectId: "trend-report-8a183",
      storageBucket: "trend-report-8a183.firebasestorage.app",
      messagingSenderId: "373855449956",
      appId: "1:373855449956:web:ac378236413ec2a76cc071"
    };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // --- Constants ---
    const appId = 'trend-report';
    const COLLECTION_NAME = 'trend_reports';
    const urlParams = new URLSearchParams(window.location.search);
    const DOC_ID = urlParams.get('week') || 'latest';
    const FULL_PATH_ARGS = ['artifacts', appId, 'public', 'data', COLLECTION_NAME, DOC_ID];

    // --- Default Data ---
    const INITIAL_DATA = {
      cover: { tag: "TREND REPORT", title: "Ïä§Ìä∏Î¶¨Î∞ç ÌîåÎû´Ìèº\nÌä∏Î†åÎìú Î¶¨Ìè¨Ìä∏", date: "2026. 02. 3rd Week" },
      ranking: {
        title: "Category Ranking", subtitle: "2Ïõî 3Ï£ºÏ∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàúÏúÑ",
        chzzk: [
          { rank: "01", name: "ÎèôÍ≥Ñ Ïò¨Î¶ºÌîΩ", tag: "‚ñ≤ 2" }, { rank: "02", name: "Talk", tag: "‚ñº 1" },
          { rank: "03", name: "Î¶¨Í∑∏ Ïò§Î∏å Î†àÏ†ÑÎìú", tag: "‚ñº 1" }, { rank: "04", name: "Ïò§Î≤ÑÏõåÏπò2", tag: "‚ñ≤ 4" },
          { rank: "05", name: "Î¶ºÏõîÎìú", tag: "‚ñ≤ 2" }, { rank: "06", name: "Î°úÏä§Ìä∏ÏïÑÌÅ¨", tag: "‚ñ≤ 4" },
          { rank: "07", name: "Ïù¥ÌÑ∞ÎÑê Î¶¨ÌÑ¥", tag: "‚ñ≤ 2" }, { rank: "08", name: "ÎØ∏ÏÑ§Ï†ï", tag: "NEW" },
          { rank: "09", name: "Îçî Í≤åÏûÑ Ïò§Î∏å ÎùºÏù¥ÌîÑ", tag: "NEW" }, { rank: "10", name: "ÎîîÏïÑÎ∏îÎ°ú2", tag: "NEW" }
        ],
        soop: [
          { rank: "01", name: "ÌÜ†ÌÅ¨/Ï∫†Î∞©", tag: "-" }, { rank: "02", name: "Î¶¨Í∑∏ Ïò§Î∏å Î†àÏ†ÑÎìú", tag: "-" },
          { rank: "03", name: "Î≤ÑÏ∂îÏñº", tag: "-" }, { rank: "04", name: "Ïä§ÌÉÄÌÅ¨ÎûòÌîÑÌä∏", tag: "-" },
          { rank: "05", name: "PUBG: Î∞∞ÌãÄÍ∑∏ÎùºÏö¥Îìú", tag: "-" }, { rank: "06", name: "LCK", tag: "-" },
          { rank: "07", name: "Ïó¨Ìñâ", tag: "‚ñ≤ 3" }, { rank: "08", name: "Ï¢ÖÌï©Í≤åÏûÑ", tag: "‚ñº 1" },
          { rank: "09", name: "ÏÑúÎì†Ïñ¥ÌÉù", tag: "‚ñº 1" }, { rank: "10", name: "ÎßàÏù∏ÌÅ¨ÎûòÌîÑÌä∏", tag: "NEW" }
        ]
      },
      issues: {
        chzzk: {
          title: "Chzzk Highlights", subtitle: "2Ïõî 3Ï£ºÏ∞® Ï£ºÏöî Ïù¥Ïäà",
          items: [
            { id: "c1", badge: "LEAGUE & UPDATE", title: "Ïò§Î≤ÑÏõåÏπò (Îü¨ÎÑàÎ¶¨Í∑∏ ÏãúÏ¶å4 & Î¶¨Î∏åÎûúÎî©)", desc: "Ïã†Í∑ú Ï∫êÎ¶≠ÌÑ∞ 5Î™Ö Î∞è Î¶¨Î∏åÎûúÎî© Ìö®Í≥ºÎ°ú ÏßÄÌëú Î∞òÎì±.", stat: "üéÆ Ïπ¥ÌÖåÍ≥†Î¶¨ Peak 27,990", image: null },
            { id: "c2", badge: "EVENT MATCH", title: "ÏπòÏä§Ìã∞Î≤å (ÏÜåÎãâ Î†àÏù¥Ïã± ÌÅ¨Î°úÏä§ÏõîÎìú)", desc: "Í≥µÏãù Ï±ÑÎÑê ÏúÑÏ£º Î∑∞Ïñ¥Ïã≠ Ïú†Ìö®.", stat: "üèÅ Í≥µÏãù Ï±ÑÎÑê Peak 10,073", image: null }
          ]
        },
        soop: {
          title: "SOOP Highlights", subtitle: "2Ïõî 3Ï£ºÏ∞® Ï£ºÏöî Ïù¥Ïäà",
          items: [
            { id: "s1", badge: "CONTENTS HIT", title: "PUBG: Î∞∞ÌãÄÍ∑∏ÎùºÏö¥Îìú", desc: "ÎåÄÌòï Ïä§Ìä∏Î¶¨Î®∏Îì§Ïùò ÌôúÎ∞úÌïú Ï∞∏Ïó¨Í∞Ä Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàúÏúÑ ÏÉÅÏäπ Í≤¨Ïù∏.", stat: "üî´ Ïπ¥ÌÖåÍ≥†Î¶¨ 5ÏúÑ | Peak 86,679", image: null },
            { id: "s2", badge: "NEW ENTRY", title: "Î¶¨ÎãàÏßÄ ÌÅ¥ÎûòÏãù", desc: "Ï∞®Ï£º ÏßÄÌëú ÌïòÎùΩ ÏòàÏÉÅ.", stat: "‚öîÔ∏è Ïπ¥ÌÖåÍ≥†Î¶¨ 9ÏúÑ | Peak 25,356", image: null }
          ]
        }
      },
      ending: { text: "E.O.D", contact: "Î¨∏Ïùò: branding_team@nexon.co.kr" }
    };

    // --- Icons ---
    const UploadIcon = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={{ marginBottom: '8px' }}>
        <path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242" />
        <path d="M12 12v9" /><path d="m16 16-4-4-4 4" />
      </svg>
    );

    const FullScreenIcon = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
      </svg>
    );

    const CheckIcon = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#00FFA3" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
    );

    const LoadingSpinner = () => (
      <svg className="animate-spin" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ff4d4d" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round">
        <path d="M21 12a9 9 0 1 1-6.219-8.56" />
      </svg>
    );

    // --- Components ---
    const EditableText = ({ text, className, onSave, multiline = false, style }) => {
      const handleBlur = (e) => {
        const newText = e.target.innerText;
        if (newText !== text) onSave(newText);
      };
      const handleKeyDown = (e) => {
        if (!multiline && e.key === 'Enter') { e.preventDefault(); e.target.blur(); }
      };
      return (
        <div className={className} style={{ minWidth: '50px', minHeight: '1.2em', display: 'inline-block', ...style }}
          contentEditable suppressContentEditableWarning onBlur={handleBlur} onKeyDown={handleKeyDown}
          dangerouslySetInnerHTML={{ __html: text ? text.replace(/\n/g, '<br>') : '' }}
        />
      );
    };

    const SmartTag = ({ tag, onSave }) => {
      const getTagClass = (t) => {
        const text = t ? t.toUpperCase() : '';
        if (text.includes('NEW') || text.includes('Ïã†Í∑ú')) return 'tag-new';
        if (text.includes('‚ñ≤') || text.includes('ÏÉÅÏäπ') || text.includes('‚Üë')) return 'tag-up';
        if (text.includes('‚ñº') || text.includes('ÌïòÎùΩ') || text.includes('‚Üì')) return 'tag-down';
        return 'tag-dash';
      };
      return (
        <div className={`rank-tag ${getTagClass(tag)}`} style={{ minWidth: '40px', minHeight: '20px' }}
          contentEditable suppressContentEditableWarning onBlur={(e) => onSave(e.target.innerText)}
          onKeyDown={(e) => { if(e.key==='Enter') { e.preventDefault(); e.target.blur(); } }}>
          {tag}
        </div>
      );
    };

    const ImageUploader = ({ currentImage, onSave }) => {
      const fileInputRef = useRef(null);
      const [loading, setLoading] = useState(false);

      const handleFileChange = (e) => {
        const file = e.target.files?.[0];
        if (!file) return;
        setLoading(true);
        const reader = new FileReader();
        reader.onload = (event) => {
          const img = new Image();
          img.onload = () => {
            const canvas = document.createElement('canvas');
            const MAX_WIDTH = 800;
            let width = img.width; let height = img.height;
            if (width > MAX_WIDTH) { height *= MAX_WIDTH / width; width = MAX_WIDTH; }
            canvas.width = width; canvas.height = height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, width, height);
            onSave(canvas.toDataURL('image/jpeg', 0.8));
            setLoading(false);
          };
          img.src = event.target.result;
        };
        reader.readAsDataURL(file);
      };

      return (
        <div className="issue-img" onClick={() => fileInputRef.current?.click()}>
          {currentImage ? <img src={currentImage} alt="Uploaded" /> : <><UploadIcon /><span>{loading ? "Ï≤òÎ¶¨Ï§ë..." : "ÌÅ¥Î¶≠ÌïòÏó¨ Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú"}</span></>}
          <input type="file" ref={fileInputRef} style={{display: 'none'}} accept="image/*" onChange={handleFileChange} />
        </div>
      );
    };

    // --- Main App Component ---
    function App() {
      const [user, setUser] = useState(null);
      const [data, setData] = useState(null);
      const [loading, setLoading] = useState(true);
      const [saveStatus, setSaveStatus] = useState('saved'); 
      const [scale, setScale] = useState(1);

      useEffect(() => {
        const initAuth = async () => {
          try { 
            // Canvas ÌôòÍ≤ΩÏùò ÌÜ†ÌÅ∞ Ï£ºÏûÖ ÏãúÎèÑÎ•º ÏõêÏ≤ú Ï∞®Îã®ÌïòÍ≥† Í∞ïÏ†úÎ°ú ÏùµÎ™Ö Î°úÍ∑∏Ïù∏ÏùÑ ÏàòÌñâÌïòÏó¨ auth/custom-token-mismatch ÏóêÎü¨Î•º Ìï¥Í≤∞Ìï©ÎãàÎã§.
            await signInAnonymously(auth); 
          } 
          catch (error) { 
            console.error("Ïù∏Ï¶ù Ïã§Ìå®:", error); 
          }
        };
        initAuth();
        const unsubscribe = onAuthStateChanged(auth, setUser);
        return () => unsubscribe();
      }, []);

      useEffect(() => {
        if (!user) return;
        const docRef = doc(db, ...FULL_PATH_ARGS);
        const unsubscribe = onSnapshot(docRef, (docSnap) => {
          if (docSnap.exists()) { setData(docSnap.data()); } 
          else { setDoc(docRef, INITIAL_DATA); setData(INITIAL_DATA); }
          setLoading(false);
        }, (error) => {
          console.error("Data fetch error:", error);
          setLoading(false);
        });
        return () => unsubscribe();
      }, [user]);

      useEffect(() => {
        const handleResize = () => {
          const availableWidth = window.innerWidth - 40; 
          setScale(Math.min(availableWidth / 1280, 1));
        };
        window.addEventListener('resize', handleResize);
        handleResize(); 
        return () => window.removeEventListener('resize', handleResize);
      }, []);

      const updateField = async (path, value) => {
        if (!user || !data) return;
        setSaveStatus('saving');
        const docRef = doc(db, ...FULL_PATH_ARGS);
        await updateDoc(docRef, { [path]: value });
        setTimeout(() => setSaveStatus('saved'), 500); 
      };

      const updateNestedArray = async (section, platform, index, field, value) => {
        if (!user || !data) return;
        setSaveStatus('saving');
        const newList = [...data[section][platform]];
        newList[index] = { ...newList[index], [field]: value };
        const docRef = doc(db, ...FULL_PATH_ARGS);
        await updateDoc(docRef, { [`${section}.${platform}`]: newList });
        setTimeout(() => setSaveStatus('saved'), 500);
      };

      const updateIssue = async (platform, index, field, value) => {
        if (!user || !data) return;
        setSaveStatus('saving');
        const newList = [...data.issues[platform].items];
        newList[index] = { ...newList[index], [field]: value };
        const docRef = doc(db, ...FULL_PATH_ARGS);
        await updateDoc(docRef, { [`issues.${platform}.items`]: newList });
        setTimeout(() => setSaveStatus('saved'), 500);
      };

      const toggleFullScreen = async () => {
        try {
          if (!document.fullscreenElement) await document.documentElement.requestFullscreen();
          else if (document.exitFullscreen) await document.exitFullscreen();
        } catch (err) {
          console.warn("Full screen failed:", err);
          alert("Ï†ÑÏ≤¥ÌôîÎ©¥ Î™®ÎìúÎ•º ÏßÄÏõêÌïòÏßÄ ÏïäÏäµÎãàÎã§.");
        }
      };

      if (loading || !data) return <div className="flex h-screen w-full items-center justify-center bg-black text-white">Loading Trend Report...</div>;

      return (
        <div className="app-container">
          <style>{`
            @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;700;900&family=Teko:wght@600&display=swap');
            .app-container { background-color: #0a0a0a; color: white; font-family: 'Noto Sans KR', sans-serif; display: flex; flex-direction: column; align-items: center; gap: 20px; padding: 40px 0; min-height: 100vh; overflow-x: hidden; }
            .slide-wrapper { transition: transform 0.2s ease-out; transform-origin: top center; }
            .slide { width: 1280px; height: 720px; background-color: #000000; position: relative; padding: 50px; overflow: hidden; border: 1px solid #333; box-shadow: 0 10px 40px rgba(0,0,0,0.5); flex-shrink: 0; margin-bottom: 20px; }
            .bg-glow { position: absolute; width: 500px; height: 500px; border-radius: 50%; filter: blur(120px); opacity: 0.1; pointer-events: none; z-index: 0; }
            .glow-chzzk { background: #00FFA3; top: -200px; left: -200px; }
            .glow-soop { background: #00A9E0; bottom: -200px; right: -200px; }
            .slide-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 15px; position: relative; z-index: 1; }
            .slide-title { font-size: 36px; font-weight: 700; text-transform: uppercase; }
            .slide-subtitle { font-size: 18px; color: #888; font-weight: 500; }
            .cover-content { height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: flex-start; z-index: 1; position: relative; }
            .cover-tag { background: #222; color: #00FFA3; padding: 8px 16px; border-radius: 20px; font-weight: 700; margin-bottom: 20px; font-size: 18px; border: 1px solid #00FFA3; }
            .cover-title { font-size: 72px; font-weight: 900; line-height: 1.1; margin-bottom: 20px; background: linear-gradient(90deg, #fff, #aaa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
            .cover-date { font-size: 32px; color: #666; font-weight: 300; }
            .rank-container { display: flex; gap: 40px; height: 580px; position: relative; z-index: 1; }
            .col-header { text-align: center; padding-bottom: 15px; margin-bottom: 15px; border-bottom: 1px solid #333; }
            .platform-logo { font-family: 'Teko', sans-serif; font-size: 36px; font-weight: 600; }
            .chzzk-col .platform-logo { color: #00FFA3; }
            .soop-col .platform-logo { color: #00A9E0; }
            .rank-column { flex: 1; background: rgba(255,255,255,0.03); border-radius: 12px; padding: 20px; border: 1px solid #222; }
            .chzzk-col { border-top: 4px solid #00FFA3; }
            .soop-col { border-top: 4px solid #00A9E0; }
            .rank-item { display: flex; align-items: center; height: 42px; border-bottom: 1px solid #222; color: #ddd; }
            .rank-num { width: 30px; font-weight: 900; font-family: 'Teko'; font-size: 22px; }
            .chzzk-col .rank-num { color: #00FFA3; }
            .soop-col .rank-num { color: #00A9E0; }
            .game-name { flex: 1; font-size: 16px; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
            .rank-tag { font-size: 11px; padding: 2px 6px; border-radius: 4px; font-weight: 700; min-width: 40px; text-align: center; cursor: text; }
            .tag-new { background: #E5A00D; color: #000; }
            .tag-up { color: #ff4d4d; background: transparent; border: 1px solid #ff4d4d; }
            .tag-down { color: #4d94ff; background: transparent; border: 1px solid #4d94ff; }
            .tag-dash { color: #555; background: transparent; border: 1px solid #333; }
            .issue-container { display: flex; flex-direction: column; gap: 20px; height: 100%; position: relative; z-index: 1; }
            .issue-card { display: flex; background: #161616; border-radius: 12px; overflow: hidden; border: 1px solid #333; height: 250px; }
            .issue-img { width: 350px; background-color: #222; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #666; font-size: 14px; cursor: pointer; position: relative; transition: background 0.3s; }
            .issue-img:hover { background-color: #2a2a2a; color: #fff; }
            .issue-img img { width: 100%; height: 100%; object-fit: cover; }
            .issue-content { flex: 1; padding: 30px; display: flex; flex-direction: column; justify-content: center; }
            .issue-badge { display: inline-block; padding: 4px 10px; border-radius: 4px; font-size: 12px; font-weight: 700; margin-bottom: 10px; width: fit-content; }
            .bdg-chzzk { background: rgba(0, 255, 163, 0.2); color: #00FFA3; border: 1px solid #00FFA3; }
            .bdg-soop { background: rgba(0, 169, 224, 0.2); color: #00A9E0; border: 1px solid #00A9E0; }
            .issue-title { font-size: 28px; font-weight: 700; margin-bottom: 10px; color: #fff; }
            .issue-desc { font-size: 16px; color: #aaa; line-height: 1.6; margin-bottom: 20px; }
            .issue-stat { font-size: 14px; color: #fff; font-weight: 500; border-top: 1px solid #333; padding-top: 15px; }
            .stat-highlight { color: #ffeb3b; font-weight: 700; }
            .end-slide { display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; height: 100%; }
            .end-line { width: 100px; height: 4px; background: linear-gradient(90deg, #00FFA3, #00A9E0); margin-bottom: 30px; }
            .end-text { font-size: 40px; font-weight: 700; color: #fff; margin-bottom: 10px; }
            .contact-info { font-size: 20px; color: #666; font-weight: 300; }
            .ui-controls { position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 9999; background: rgba(0,0,0,0.8); padding: 8px 12px; border-radius: 30px; border: 1px solid #333; align-items: center; }
            .status-badge { display: flex; align-items: center; gap: 6px; font-size: 12px; font-weight: 700; color: #fff; margin-right: 10px; }
            .control-btn { background: #333; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; display: flex; align-items: center; gap: 5px; }
            .control-btn:hover { background: #555; }
            .animate-spin { animation: spin 1s linear infinite; }
            @keyframes spin { 100% { transform: rotate(360deg); } }
            [contenteditable]:focus { outline: 1px dashed #555; }
          `}</style>

          <div className="ui-controls">
            <div className="status-badge">
              {saveStatus === 'saving' ? <><LoadingSpinner /> Ï†ÄÏû• Ï§ë...</> : <><CheckIcon /> Ï†ÄÏû• ÏôÑÎ£å</>}
            </div>
            <button onClick={toggleFullScreen} className="control-btn"><FullScreenIcon /> Ï†ÑÏ≤¥ÌôîÎ©¥</button>
          </div>

          <div className="slide-wrapper" style={{ transform: `scale(${scale})` }}>
            {/* Slide 1 */}
            <div className="slide">
              <div className="bg-glow glow-chzzk"></div><div className="bg-glow glow-soop"></div>
              <div className="cover-content">
                <EditableText className="cover-tag" text={data.cover.tag} onSave={(val) => updateField('cover.tag', val)} />
                <EditableText className="cover-title" text={data.cover.title} multiline onSave={(val) => updateField('cover.title', val)} />
                <EditableText className="cover-date" text={data.cover.date} onSave={(val) => updateField('cover.date', val)} />
              </div>
            </div>

            {/* Slide 2 */}
            <div className="slide">
              <div className="slide-header">
                <EditableText className="slide-title" text={data.ranking.title} onSave={(val) => updateField('ranking.title', val)} />
                <EditableText className="slide-subtitle" text={data.ranking.subtitle} onSave={(val) => updateField('ranking.subtitle', val)} />
              </div>
              <div className="rank-container">
                <div className="rank-column chzzk-col">
                  <div className="col-header"><div className="platform-logo">CHZZK</div></div>
                  {data.ranking.chzzk.map((item, idx) => (
                    <div key={`c-${idx}`} className="rank-item">
                      <div className="rank-num">{item.rank}</div>
                      <EditableText className="game-name" text={item.name} onSave={(val) => updateNestedArray('ranking', 'chzzk', idx, 'name', val)} />
                      <SmartTag tag={item.tag} onSave={(val) => updateNestedArray('ranking', 'chzzk', idx, 'tag', val)} />
                    </div>
                  ))}
                </div>
                <div className="rank-column soop-col">
                  <div className="col-header"><div className="platform-logo">SOOP</div></div>
                  {data.ranking.soop.map((item, idx) => (
                    <div key={`s-${idx}`} className="rank-item">
                      <div className="rank-num">{item.rank}</div>
                      <EditableText className="game-name" text={item.name} onSave={(val) => updateNestedArray('ranking', 'soop', idx, 'name', val)} />
                      <SmartTag tag={item.tag} onSave={(val) => updateNestedArray('ranking', 'soop', idx, 'tag', val)} />
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* Slide 3 */}
            <div className="slide">
              <div className="slide-header">
                <EditableText className="slide-title" style={{color: '#00FFA3'}} text={data.issues.chzzk.title} onSave={(val) => updateField('issues.chzzk.title', val)} />
                <EditableText className="slide-subtitle" text={data.issues.chzzk.subtitle} onSave={(val) => updateField('issues.chzzk.subtitle', val)} />
              </div>
              <div className="issue-container">
                {data.issues.chzzk.items.map((item, idx) => (
                  <div key={item.id} className="issue-card">
                    <ImageUploader currentImage={item.image} onSave={(val) => updateIssue('chzzk', idx, 'image', val)} />
                    <div className="issue-content">
                      <EditableText className="issue-badge bdg-chzzk" text={item.badge} onSave={(val) => updateIssue('chzzk', idx, 'badge', val)} />
                      <EditableText className="issue-title" text={item.title} onSave={(val) => updateIssue('chzzk', idx, 'title', val)} />
                      <EditableText className="issue-desc" text={item.desc} multiline onSave={(val) => updateIssue('chzzk', idx, 'desc', val)} />
                      <EditableText className="issue-stat" text={item.stat} onSave={(val) => updateIssue('chzzk', idx, 'stat', val)} />
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Slide 4 */}
            <div className="slide">
              <div className="slide-header">
                <EditableText className="slide-title" style={{color: '#00A9E0'}} text={data.issues.soop.title} onSave={(val) => updateField('issues.soop.title', val)} />
                <EditableText className="slide-subtitle" text={data.issues.soop.subtitle} onSave={(val) => updateField('issues.soop.subtitle', val)} />
              </div>
              <div className="issue-container">
                {data.issues.soop.items.map((item, idx) => (
                  <div key={item.id} className="issue-card">
                    <ImageUploader currentImage={item.image} onSave={(val) => updateIssue('soop', idx, 'image', val)} />
                    <div className="issue-content">
                      <EditableText className="issue-badge bdg-soop" text={item.badge} onSave={(val) => updateIssue('soop', idx, 'badge', val)} />
                      <EditableText className="issue-title" text={item.title} onSave={(val) => updateIssue('soop', idx, 'title', val)} />
                      <EditableText className="issue-desc" text={item.desc} multiline onSave={(val) => updateIssue('soop', idx, 'desc', val)} />
                      <EditableText className="issue-stat" text={item.stat} onSave={(val) => updateIssue('soop', idx, 'stat', val)} />
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Slide 5 */}
            <div className="slide">
              <div className="bg-glow glow-chzzk" style={{opacity:0.05}}></div><div className="bg-glow glow-soop" style={{opacity:0.05}}></div>
              <div className="end-slide">
                <div className="end-line"></div>
                <EditableText className="end-text" text={data.ending.text} onSave={(val) => updateField('ending.text', val)} />
                <EditableText className="contact-info" text={data.ending.contact} onSave={(val) => updateField('ending.contact', val)} />
              </div>
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>